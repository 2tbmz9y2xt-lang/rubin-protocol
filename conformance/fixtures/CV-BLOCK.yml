version: "1.1"
gate: CV-BLOCK
status: PASS
description: "Block validation via apply-block CLI (linkage, target/pow, merkle, timestamp bounds, nonce replay, weight/anchor caps, coinbase rules, subsidy bound)"
tests:
  - id: BLOCK-01
    title: "Invalid prev_block_hash => BLOCK_ERR_LINKAGE_INVALID"
    context: { case: LINKAGE_INVALID }
    expected_error: BLOCK_ERR_LINKAGE_INVALID
    consensus: true

  - id: BLOCK-02
    title: "Invalid target mismatch => BLOCK_ERR_TARGET_INVALID"
    context: { case: TARGET_INVALID }
    expected_error: BLOCK_ERR_TARGET_INVALID
    consensus: true

  - id: BLOCK-03
    title: "PoW invalid (target=0) => BLOCK_ERR_POW_INVALID"
    context: { case: POW_INVALID }
    expected_error: BLOCK_ERR_POW_INVALID
    consensus: true

  - id: BLOCK-04
    title: "Merkle mismatch => BLOCK_ERR_MERKLE_INVALID"
    context: { case: MERKLE_INVALID }
    expected_error: BLOCK_ERR_MERKLE_INVALID
    consensus: true

  - id: BLOCK-05
    title: "Anchor bytes exceeded => BLOCK_ERR_ANCHOR_BYTES_EXCEEDED"
    context: { case: ANCHOR_BYTES_EXCEEDED }
    expected_error: BLOCK_ERR_ANCHOR_BYTES_EXCEEDED
    consensus: true

  - id: BLOCK-06
    title: "Coinbase invalid: second coinbase tx present => BLOCK_ERR_COINBASE_INVALID"
    context: { case: COINBASE_INVALID_TWO_COINBASE }
    expected_error: BLOCK_ERR_COINBASE_INVALID
    consensus: true

  - id: BLOCK-07
    title: "Median-time-vs-timestamp old bound violation => BLOCK_ERR_TIMESTAMP_OLD"
    context: { case: TIMESTAMP_OLD }
    expected_error: BLOCK_ERR_TIMESTAMP_OLD
    consensus: true

  - id: BLOCK-08
    title: "Future timestamp cap violation => BLOCK_ERR_TIMESTAMP_FUTURE"
    context:
      case: TIMESTAMP_FUTURE
      local_time: 1700000000
    expected_error: BLOCK_ERR_TIMESTAMP_FUTURE
    consensus: true

  - id: BLOCK-09
    title: "Subsidy exceeded => BLOCK_ERR_SUBSIDY_EXCEEDED"
    context: { case: SUBSIDY_EXCEEDED }
    expected_error: BLOCK_ERR_SUBSIDY_EXCEEDED
    consensus: true

  - id: BLOCK-10
    title: "Duplicate non-coinbase tx_nonce in one block => TX_ERR_NONCE_REPLAY"
    context: { case: NONCE_REPLAY }
    expected_error: TX_ERR_NONCE_REPLAY
    consensus: true

  - id: BLOCK-11
    title: "Block total weight exceeded => BLOCK_ERR_WEIGHT_EXCEEDED"
    context: { case: WEIGHT_EXCEEDED }
    expected_error: BLOCK_ERR_WEIGHT_EXCEEDED
    consensus: true
