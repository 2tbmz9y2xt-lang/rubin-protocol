version: "1.1"
gate: CV-BIND
status: PASS
description: "Witness/covenant binding and serialization binding semantics"
tests:
  - id: BIND-01
    title: "Unknown suite_id rejected as non-consensus algorithm"
    context:
      covenant_type: CORE_P2PK
      suite_id: 0xF0
      pubkey_length: 32
      sig_length: 64
    expected_error: TX_ERR_SIG_ALG_INVALID
    consensus: true

  - id: BIND-02
    title: "Sentinel witness must be zero-length"
    context:
      suite_id: 0x00
      pubkey_length: 0
      sig_length: 1
    expected_error: TX_ERR_PARSE
    consensus: true

  - id: BIND-03
    title: "CORE_TIMELOCK requires zero-length sentinel witness"
    context:
      covenant_type: CORE_TIMELOCK_V1
      suite_id: 0x01
      pubkey_length: 0
      sig_length: 64
      lock_value: 1_000_000
    expected_error: TX_ERR_SIG_ALG_INVALID
    consensus: true
