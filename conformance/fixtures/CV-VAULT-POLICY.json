{
  "gate": "CV-VAULT-POLICY",
  "vectors": [
    {
      "id": "CV-V-01",
      "op": "vault_policy_rules",
      "expect_ok": false,
      "expect_err": "TX_ERR_VAULT_MULTI_INPUT_FORBIDDEN",
      "vault_input_count": 2,
      "owner_lock_id": "owner-a",
      "non_vault_lock_ids": [
        "owner-a"
      ],
      "has_owner_auth": true,
      "sum_in_vault": 100,
      "sum_out": 100,
      "slots": 2,
      "key_count": 2,
      "sig_threshold_ok": true,
      "whitelist": [
        "01",
        "02"
      ]
    },
    {
      "id": "CV-V-02",
      "op": "vault_policy_rules",
      "expect_ok": false,
      "expect_err": "TX_ERR_VAULT_FEE_SPONSOR_FORBIDDEN",
      "vault_input_count": 1,
      "owner_lock_id": "owner-a",
      "non_vault_lock_ids": [
        "owner-a",
        "third-party-b"
      ],
      "has_owner_auth": true,
      "sum_in_vault": 100,
      "sum_out": 100,
      "slots": 1,
      "key_count": 1,
      "sig_threshold_ok": true,
      "whitelist": [
        "01",
        "02"
      ]
    },
    {
      "id": "CV-V-03",
      "op": "vault_policy_rules",
      "expect_ok": true,
      "vault_input_count": 1,
      "owner_lock_id": "owner-a",
      "non_vault_lock_ids": [
        "owner-a",
        "owner-a"
      ],
      "has_owner_auth": true,
      "sum_in_vault": 100,
      "sum_out": 110,
      "slots": 2,
      "key_count": 2,
      "sig_threshold_ok": true,
      "whitelist": [
        "01",
        "02",
        "03"
      ]
    },
    {
      "id": "CV-V-04",
      "op": "vault_policy_rules",
      "expect_ok": false,
      "expect_err": "TX_ERR_PARSE",
      "vault_input_count": 1,
      "owner_lock_id": "owner-a",
      "non_vault_lock_ids": [
        "owner-a"
      ],
      "has_owner_auth": true,
      "sum_in_vault": 100,
      "sum_out": 100,
      "slots": 1,
      "key_count": 1,
      "sig_threshold_ok": true,
      "sentinel_suite_id": 0,
      "sentinel_pubkey_len": 0,
      "sentinel_sig_len": 1,
      "sentinel_verify_called": true,
      "whitelist": [
        "01"
      ]
    },
    {
      "id": "CV-V-05",
      "op": "vault_policy_rules",
      "expect_ok": false,
      "expect_err": "TX_ERR_VAULT_WHITELIST_NOT_CANONICAL",
      "vault_input_count": 1,
      "owner_lock_id": "owner-a",
      "non_vault_lock_ids": [
        "owner-a"
      ],
      "has_owner_auth": true,
      "sum_in_vault": 100,
      "sum_out": 100,
      "slots": 1,
      "key_count": 1,
      "sig_threshold_ok": true,
      "whitelist": [
        "02",
        "01",
        "02"
      ]
    },
    {
      "id": "CV-V-06",
      "op": "vault_policy_rules",
      "expect_ok": false,
      "expect_err": "TX_ERR_VAULT_MULTI_INPUT_FORBIDDEN",
      "vault_input_count": 2,
      "owner_lock_id": "owner-a",
      "non_vault_lock_ids": [
        "third-party-b"
      ],
      "has_owner_auth": false,
      "sum_in_vault": 100,
      "sum_out": 90,
      "slots": 0,
      "key_count": 2,
      "sig_threshold_ok": false,
      "sentinel_suite_id": 1,
      "sentinel_pubkey_len": 32,
      "sentinel_sig_len": 20,
      "sentinel_verify_called": true,
      "whitelist": [
        "03",
        "01",
        "03"
      ],
      "validation_order": [
        "multi_vault",
        "owner_auth",
        "fee_sponsor",
        "witness_slots",
        "sentinel",
        "sig_threshold",
        "whitelist",
        "value"
      ]
    },
    {
      "id": "CV-V-07",
      "op": "vault_policy_rules",
      "expect_ok": true,
      "vault_input_count": 1,
      "owner_lock_id": "owner-a",
      "non_vault_lock_ids": [
        "owner-a"
      ],
      "has_owner_auth": true,
      "sum_in_vault": 100,
      "sum_out": 100,
      "slots": 1,
      "key_count": 1,
      "sig_threshold_ok": true,
      "whitelist": [
        "01",
        "02"
      ]
    },
    {
      "id": "CV-V-08",
      "op": "vault_policy_rules",
      "expect_ok": false,
      "expect_err": "TX_ERR_VALUE_CONSERVATION",
      "vault_input_count": 1,
      "owner_lock_id": "owner-a",
      "non_vault_lock_ids": [
        "owner-a"
      ],
      "has_owner_auth": true,
      "sum_in_vault": 100,
      "sum_out": 99,
      "slots": 1,
      "key_count": 1,
      "sig_threshold_ok": true,
      "whitelist": [
        "01",
        "02"
      ]
    },
    {
      "id": "CV-V-09",
      "op": "vault_policy_rules",
      "expect_ok": true,
      "vault_input_count": 1,
      "owner_lock_id": "owner-a",
      "non_vault_lock_ids": [
        "owner-a"
      ],
      "has_owner_auth": true,
      "sum_in_vault": 100,
      "sum_out": 101,
      "slots": 1,
      "key_count": 1,
      "sig_threshold_ok": true,
      "whitelist": [
        "01",
        "02"
      ]
    }
  ]
}
