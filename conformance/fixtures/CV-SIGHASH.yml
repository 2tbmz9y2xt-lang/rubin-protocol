version: '1.1'
gate: CV-SIGHASH
status: PASS
description: Deterministic txid (no-witness) and sighash v1 digest vectors
tests:
- id: SIGHASH-01
  title: txid excludes witness bytes
  context:
    tx_hex: 0200000000010000000000000001111111111111111111111111111111111111111111111111111111111111111100000000000100000001e803000000000000000021012222222222222222222222222222222222222222222222222222222222222222000000000100000000
  expected_txid_sha3_256_hex: e4586d97c7ae51026a986b5fde65cd8b816fd4a914d70345add1a8826a18a70d
  consensus: true
- id: SIGHASH-02
  title: sighash v1 commits all inputs + input_value
  context:
    chain_id_hex: 7dcf48a266788491e77bbb7b9c97ad6a2c89b882293dfaf3bdebeec62548cc00
    input_index: 0
    input_value: 1000
    tx_hex: 0200000000010000000000000001111111111111111111111111111111111111111111111111111111111111111100000000000100000001e803000000000000000021012222222222222222222222222222222222222222222222222222222222222222000000000100000000
  expected_sighash_v1_hex: cd53ce3f0522d993636ec321790e1e65ad1340e646528f2284fb1380ce282b02
  consensus: true
- id: SIGHASH-03
  title: txid excludes witness bytes (multi-input)
  context:
    tx_hex: 02000000000100000000000000021111111111111111111111111111111111111111111111111111111111111111000000000001000000222222222222222222222222222222222222222222222222222222222222222201000000000200000001e803000000000000000021013333333333333333333333333333333333333333333333333333333333333333000000000200000000000000
  expected_txid_sha3_256_hex: c9b49c929906f6bb81738c21e917009716dfed98e2a1a301b94c4ea0ceaa39b7
  consensus: true
- id: SIGHASH-04
  title: sighash v1 hashPrevouts/hashSequences (input 0)
  context:
    chain_id_hex: 7dcf48a266788491e77bbb7b9c97ad6a2c89b882293dfaf3bdebeec62548cc00
    input_index: 0
    input_value: 1111
    tx_hex: 02000000000100000000000000021111111111111111111111111111111111111111111111111111111111111111000000000001000000222222222222222222222222222222222222222222222222222222222222222201000000000200000001e803000000000000000021013333333333333333333333333333333333333333333333333333333333333333000000000200000000000000
  expected_sighash_v1_hex: 9275784a1d73253302421578ad9dccc58eebff6a6611fc5694d7cd458a31ab80
  consensus: true
- id: SIGHASH-05
  title: sighash v1 hashPrevouts/hashSequences (input 1)
  context:
    chain_id_hex: 7dcf48a266788491e77bbb7b9c97ad6a2c89b882293dfaf3bdebeec62548cc00
    input_index: 1
    input_value: 2222
    tx_hex: 02000000000100000000000000021111111111111111111111111111111111111111111111111111111111111111000000000001000000222222222222222222222222222222222222222222222222222222222222222201000000000200000001e803000000000000000021013333333333333333333333333333333333333333333333333333333333333333000000000200000000000000
  expected_sighash_v1_hex: 82047d6a03cfcf75cff611ada4d0e0df576d7fb429c1474a7874c3f670487200
  consensus: true
- id: SIGHASH-06
  title: sighash v1 output_count=0 uses SHA3-256("") for hashOutputs
  context:
    chain_id_hex: 7dcf48a266788491e77bbb7b9c97ad6a2c89b882293dfaf3bdebeec62548cc00
    input_index: 0
    input_value: 1000
    tx_hex: '0200000000010000000000000001111111111111111111111111111111111111111111111111111111111111111100000000000100000000000000000100000000'
  expected_txid_sha3_256_hex: af688d67cf657df9148d7784d5eb40395cb939144dd4c6521e3e107268221305
  expected_sighash_v1_hex: e7dc761f6e79f47bf0b0f51bb4108f8fa380de13ce38da51113ea386f98c949f
  consensus: true
