version: "1.1"
gate: CV-SIGHASH
status: PASS
description: "Deterministic txid (no-witness) and sighash v1 digest vectors"
tests:
  - id: SIGHASH-01
    title: "txid excludes witness bytes"
    context:
      tx_hex: "01000000010000000000000001111111111111111111111111111111111111111111111111111111111111111100000000000100000001e8030000000000000000210122222222222222222222222222222222222222222222222222222222222222220000000001000000"
    expected_txid_sha3_256_hex: "d3084af1b6f5fe3214ca0cfb95e766fba57c81dc91857f72b994e91bb1e04d5d"
    consensus: true

  - id: SIGHASH-02
    title: "sighash v1 commits all inputs + input_value"
    context:
      chain_id_hex: "7dcf48a266788491e77bbb7b9c97ad6a2c89b882293dfaf3bdebeec62548cc00"
      input_index: 0
      input_value: 1000
      tx_hex: "01000000010000000000000001111111111111111111111111111111111111111111111111111111111111111100000000000100000001e8030000000000000000210122222222222222222222222222222222222222222222222222222222222222220000000001000000"
    expected_sighash_v1_hex: "a5acba2dc4fd50068e9b0c53f118de87b07cf4b8d06c1d4d555fd8e310a93ee6"
    consensus: true

  - id: SIGHASH-03
    title: "txid excludes witness bytes (multi-input)"
    context:
      tx_hex: "010000000100000000000000021111111111111111111111111111111111111111111111111111111111111111000000000001000000222222222222222222222222222222222222222222222222222222222222222201000000000200000001e8030000000000000000210133333333333333333333333333333333333333333333333333333333333333330000000002000000000000"
    expected_txid_sha3_256_hex: "fe7dec4bbc9fe7a2d3b09852e76386f84e43e4289394d318fd9038cccb181dd0"
    consensus: true

  - id: SIGHASH-04
    title: "sighash v1 hashPrevouts/hashSequences (input 0)"
    context:
      chain_id_hex: "7dcf48a266788491e77bbb7b9c97ad6a2c89b882293dfaf3bdebeec62548cc00"
      input_index: 0
      input_value: 1111
      tx_hex: "010000000100000000000000021111111111111111111111111111111111111111111111111111111111111111000000000001000000222222222222222222222222222222222222222222222222222222222222222201000000000200000001e8030000000000000000210133333333333333333333333333333333333333333333333333333333333333330000000002000000000000"
    expected_sighash_v1_hex: "c2cb75c93b1bc4e3b16a08c6ebc5cea310197d651ff80aeb9e0a9fdc68a52a54"
    consensus: true

  - id: SIGHASH-05
    title: "sighash v1 hashPrevouts/hashSequences (input 1)"
    context:
      chain_id_hex: "7dcf48a266788491e77bbb7b9c97ad6a2c89b882293dfaf3bdebeec62548cc00"
      input_index: 1
      input_value: 2222
      tx_hex: "010000000100000000000000021111111111111111111111111111111111111111111111111111111111111111000000000001000000222222222222222222222222222222222222222222222222222222222222222201000000000200000001e8030000000000000000210133333333333333333333333333333333333333333333333333333333333333330000000002000000000000"
    expected_sighash_v1_hex: "3a853b8e4553f9730ae74a398d65eda49fa6bd0637d03ec6a1085ceefda0ee70"
    consensus: true

  - id: SIGHASH-06
    title: "sighash v1 output_count=0 uses SHA3-256(\"\") for hashOutputs"
    context:
      chain_id_hex: "7dcf48a266788491e77bbb7b9c97ad6a2c89b882293dfaf3bdebeec62548cc00"
      input_index: 0
      input_value: 1000
      tx_hex: "010000000100000000000000011111111111111111111111111111111111111111111111111111111111111111000000000001000000000000000001000000"
    expected_txid_sha3_256_hex: "3273d6e97a98605866c325d5f81088fcf36882b5ed6bf71a0da80f9cfeb129e1"
    expected_sighash_v1_hex: "df3e40ccce946b98be2ca1595d9d15b6699c2ef59113d41fc3b3832bad6c9343"
    consensus: true
